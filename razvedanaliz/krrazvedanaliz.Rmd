---
title: "razvedanalis"
output: github_document
---
# Подготовка к работе

## Загрузка пакетов

```{r setup, message=FALSE, warning=FALSE}
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(GGally)
library(sandwich)
library(lmtest)
library(broom)
library(xtable)
library(ggpubr)
library(stargazer)
library(modelsummary)
library(nlWaldTest)
library(car)
library(margins)
library(Hmisc)
library(ggcorrplot)
library(ggstatsplot)

```


### Общая тема оформления для всех графиков и отключение экспоненциальной записи чисел

```{r cars}
theme_set(theme_classic(base_size = 12))
options(scipen = 999) 
```


# Загрузка данных 

```{r 1}
my_data <- read.csv("dataset.csv")
```

# Избавляем от пустых значений и убираем выбросы

```{r outliers}

data <- replace(my_data,is.na(my_data),0) 

boxplot(data) # Checking outliers

# Removing outliers from income
x <- data[data$'income' > quantile(data$'income', 0.005) & data$'income' < quantile(data$'income', 0.995),]

```


# Типы данных

```{r 2}
glimpse(x)
```


# Описательные статистики 

```{r 3}
summary(x)
```


# Графики

## Плотность распределения: доход в руб.
```{r 6}
x %>% 
  ggplot(aes(income)) + 
  geom_density(alpha = 0.25) +
  xlab("Доход в руб.") +
  ylab("")
```


## Плотность распределения: расходы на питание в руб.

```{r 7}
x %>% 
  ggplot(aes(sum_rub_buy)) + 
  geom_density(alpha = 0.25) +
  xlab("Расходы в руб.") +
  ylab("")
```


## Корреляция между категориями еды и доходом

```{r 8, warning=FALSE}
correlation = x %>% select(1:13)
rcorr(as.matrix(correlation))
```


## Корреляция между независимыми переменными
```{r 9, warning=FALSE}
correlation1 = data %>% select(13:29)
rcorr(as.matrix(correlation1))
```
### График корреляции между категориями еды и доходом
```{r 10}
ggcorrplot(cor(correlation))
```


```{r corr, warning = FALSE}
b = rcorr(as.matrix(data))
tidy(b)
```


### График корреляции между независимыми переменными
```{r 11}
ggcorrplot(cor(correlation1))

```


## Совместное распределение дохода в руб. и расходы на питание в руб.

```{r 12}
x %>% 
  ggplot(aes(x = income, y = sum_rub_buy)) +
  geom_jitter(width = 0.25, alpha = 0.5) +  
  scale_y_continuous(name = "Расходы на питание в руб.") +
  scale_x_continuous(name = "Доходы в руб.")

```
